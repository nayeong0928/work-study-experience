# JVM

운영체제에 종속받지 않고 자바를 실행/인식하는 가상 컴퓨터  

### JVM 동작 방식

1. OS로부터 메모리 할당받음
2. 자바 컴파일러가 자바 소스코드를 바이트 코드로 컴파일
3. 클래스 로더는 동적 로딩을 통해서 필요한 클래스들을 로딩/링크해서 런타임 데이터 영역으로 가지고 옴
4. 런타임 데이터 영역에 옮겨진 바이트코드들은 실행엔진에 의해 해석됨 (이 때 쓰레드 동기화, GC 발생)  


### JVM의 구조
1. 클래스 로더
2. 런타임 데이터 영역
3. 실행 엔진

### 클래스 로더

- 바이트 코드들을 런타임 데이터 영역으로 옮겨준다
- 링크: 클래스 파일을 사용하기 위해서 검증하는 과정
  - JVM 명세대로인지 확인
  - 클래스가 필요로 하는 메모리를 할당
  - 심볼릭 메모리를 다이렉트 레퍼런스로 변경

### 런타임 데이터 영역

- JVM의 메모리 영역, 메소드 영역/힙 영역/스택 영역/PC레지스터/네이티브 메소드 스택으로 구성

- 메소드 영역
  - 바이트 코드를 메모리에 올릴 때 초기화되는 대상
  - 정적 필드, 클래스 구조만 가짐
- 힙 영역
  - 동적 영역 저장 -> 인스턴스 변수, 배열 타입 등 레퍼런스 타입
  - 가비지 컬렉션의 대상
- 스택 영역
  - 임시적으로 사용되는 변수/정보 저장, 쓰레드가 종료되면 사라짐
- PC 레지스터
  - 현재 수정중인 JVM의 명령어 구조를 저장
  - 현재 작업하는 내용을 CPU에 제공하기 위한 공간
  - 원시 타입인 경우에는 값을 저장하고 참조 타입인 경우에는 실행 주소를 저장
- 네이티브 메소드 스택
  - 기계어로 작성된 프로그램을 실행

